# Bachelor's thesis : **Experience-based Image Description Generation**

## Setup note
This repository only includes samples of the images used for the different processes. In order to be able to execute most notebooks, you have to download case base images and test images. To be able to do so the download of COCO annotation files might be needed (requirements are noted in txt files).

## Directory structure
### dataset
Samples of the dataset and notebooks used to download and analyze it. Large files are referenced in txt files.

- image_downloader.ipynb: Notebook to download the case base.
- dataset_analysis.ipynb: Exploratory data analysis of the final case base used.
- annotations: COCO files needed.
- images: images samples of the final case base.

### image_recuperation
A study of different similarity metrics between images divided in three types. Each similarity type follows the same structure: a .py file with utils related to that type and a .ipynb notebook with a quick study and samples of some results using the different similarity metrics:
  - Pixel level similarities:
    - image_sim_pix.ipynb
    - image_pix_utils.py
  - Object based simillarities
    - image_sim_tag.ipynb
    - image_tag_utils.py
  - Embeddings based similarities
    - image_sim_emb.ipynb
    - image_emb_utils.py
    - embeddings_analyzer.ipynb: Subjective comparison of 4 embedding models)
  - image_utils.py: General functions tu use all the similarity metrics. These flle is imported from other directories to use the different similarity methods.

### question_recuperation
Processes to recover questions from most similar images.
- embeddings: Folder containing question embeddings generated from our base case with gte-small.
- question_embedding_generator.ipynb: Embedding generator of questions from our base case.
- question_rec.ipynb: Complete process of recuperation of the questions with the selected different models.
- question_utils.py: Utils related question recuperation.
- questions.pickle: Question embeddings list in a .pikle format.
- questions_for_test.ypynb: Code for reading test_questions.txt.
- test_questions.txt: Text file with questions selected for test images.
  
### recuperation_evaluation
Answer processing and analysis of user test done to evaluate best similarity metric for question retrieval.
- Test A.csv and Test B.csv: Files containing the user cuestionaries answers
- answer_processing.ipynb: Answer processing of user test.
- evaluation_immages: Images used in the user cuestionaries.
- The directory also contains graphs created in answer_processing to show the results.

### coco_caption_evaluation
Complete process of description generation using the best retrieval technique and incorporating a VQA system and a text generation model. This directory also contains an evaluation of the descriptions generated using COCO caption as references.
It is important to note that this directory is in part coppied from the [repository by tylin](https://github.com/tylin/coco-caption) where this metrics are calculated. We use the code in this repository to calculate those metrics for our generated descriptions.

- automatic_evaluation.ipynb: Complete process of description generation with different parameter configurations. Also contains an objective evaluation using Rouge, Bleu and CIDEr.
- embedding_evaluation.ipynb: Evaluation using text-embeddings comparison of captions.
- captions4eval.ipynb: Complete process of description generation with the best configuration attending to previous metrics.
- pycocotools2 and pycocoevalcap: Directories imported from tylin's repository in order to be able to do the comparison.
- annotations: COCO files needed
- images: Images samples of the test images used for the evaluation using objective metrics.
- The directory also contains graphs created in the notebooks with the objective evaluation results.

### description_evaluation
Answer processing and analysis of user test done to evaluate descriptions generated by our proporsal.
- images: Folder containing evaluation description images.
- Results.csv: Format .csv file with the results of evaluation test.
- results_processing.ipynb: Complete process of results analysis.

## Project memory
See Experience-based Image Description Generation.pdf to read the entire memory of our project.

##ICCBR paper
See ICCBR_2024___CBR_VQA.pdf to read our paper published in ICCBR 2024.

## References
See project memory to see all references and bibliography.

Special mention to [https://github.com/tylin/coco-caption](https://github.com/tylin/coco-caption)

## Developers
- [Rubén Gómez Blanco](https://github.com/rubengb18) (Universidad Complutense de Madrid)
- [Adrián Pérez Peinador](https://github.com/adriz27) (Universidad Complutense de Madrid)
- [Adrián Sanjuán Espejo](https://github.com/adriansanj) (Universidad Complutense de Madrid)
  
## Acknowledgement
- Belén Díaz Agudo - Tutor (Universidad Complutense de Madrid)
- Antonio Alejandro Sánchez Ruiz-Granados - Tutor (Universidad Complutense de Madrid)
